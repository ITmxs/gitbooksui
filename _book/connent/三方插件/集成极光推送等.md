> 本文是根据极光官网的文档操作后总结出:(写的不尽详细支出可以先看一下官方文档，以便理解😁)

> #### 首先简单的集成极光推送
>
> 、极光平台创建项目，Android/IOS，具体配置 p12这里就不赘述了，网上一堆
>  、pubspec.yaml -> 引入极光插件 jpush_flutter: ^0.6.3
>  、公共处main中  初始化 创建回调 具体 如下：



```dart
void initState() {
super.initState();
///极光推送
this.initJpush();
}
initJpush() async {
JPush jpush = new JPush();
jpush.applyPushAuthority(
    new NotificationSettingsIOS(sound: true, alert: true, badge: true));
//获取注册的id
jpush.getRegistrationID().then((rid) {
 //这里说一下 若别处需要使用rid 如此调用   await jpush.getRegistrationID()
  print("获取注册的id:$rid");
});
//初始化
jpush.setup(
  appKey: "这里是极光平台的appKey",
  channel: "thisChannel",
  production: false,
  debug: true, // 设置是否打印 debug 日志
);

//设置别名  实现指定用户推送
jpush.setAlias("supperman").then((map) {
  print("设置别名成功");
});

try {
  //监听消息通知
  jpush.addEventHandler(
    // 接收通知回调方法。
    onReceiveNotification: (Map<String, dynamic> message) async {
      print("flutter onReceiveNotification: $message");
    },
    // 点击通知回调方法。
    onOpenNotification: (Map<String, dynamic> message) async {
      print("flutter onOpenNotification: $message");
    },
    // 接收自定义消息回调方法。
    onReceiveMessage: (Map<String, dynamic> message) async {
      print("flutter onReceiveMessage: $message");
    },
  );
} catch (e) {
  print('极光sdk配置异常');
}
}
```

> 、Android 需要在app->build.gradle->android{...->defaultConfig {.. 此处添加配置如下



```cpp
manifestPlaceholders = [
      JPUSH_PKGNAME : applicationId,
      JPUSH_APPKEY : "xxxxxx", // NOTE: JPush 上注册的包名对应的 Appkey.
      JPUSH_CHANNEL : "thisPush", //暂时填写默认值即可
]
```

> 至此app在线调试OK

> 因为需求不会只要app在线状态下收到推送，苹果本就可以所以需要处理安卓如何接收离线推送接下来我们开始着手处理接收离线推送

> 首先去小米、vivo、魅族、oppo、华为、等手机厂商的开发者中心去注册创建项目，注意创建项目时包名要与本地项目的包名相同😄
>  然后再极光平台集成设置中填写

> 然后去看看厂商集成文档，没做过安卓是不是一头雾水，没事儿耐心看完接下来我们把那些简化一下总结后就是分为两种

> 一、小米/vivo/魅族/oppo



```cpp
manifestPlaceholders = [
      JPUSH_PKGNAME : applicationId,
      JPUSH_APPKEY : "xxxxxx", // NOTE: JPush 上注册的包名对应的 Appkey.
      JPUSH_CHANNEL : "thisPush", //暂时填写默认值即可.

      XIAOMI_APPID  : "MI-xxxxxxx",
      XIAOMI_APPKEY : "MI-xxxxxx",

      OPPO_APPKEY : "OP-xxxxxxxx", // OPPO平台注册的appkey
      OPPO_APPID : "OP-xxxxxx", // OPPO平台注册的appid
      OPPO_APPSECRET: "OP-xxxxxx",//OPPO平台注册的appsecret

      VIVO_APPKEY : "xxxxxxx", // VIVO平台注册的appkey
      VIVO_APPID : "xxxxxx", // VIVO平台注册的appid 

      MEIZU_APPKEY : "MZ-xxxxx", // 魅族平台注册的appkey
      MEIZU_APPID : "MZ-xxxxxx", // 魅族平台注册的appid
    ]     
```

> 



```dart
dependencies {
implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"
compile 'com.tencent.mm.opensdk:wechat-sdk-android-without-mta:+'
compile 'cn.jiguang.sdk.plugin:xiaomi:3.9.0'//版本号和对应的JPush版本号相同
compile 'cn.jiguang.sdk.plugin:oppo:3.9.0'//版本号和对应的JPush版本号相同
compile 'cn.jiguang.sdk.plugin:vivo:3.9.0'//版本号和对应的JPush版本号相同
compile 'cn.jiguang.sdk.plugin:meizu:3.9.0'//版本号和对应的JPush版本号相同
}
```

> 二、华为(总是ge路子)
>  、创建完项目后将agconnect-services.json文件拖入android->app下，然后将本地签名文件中的SHA256代码填入华为后台（填写完一定要点击右侧的✅）
>
> ![img](https:////upload-images.jianshu.io/upload_images/22818555-9eecc7d7a9ac01e1.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)
>
> image.png
>
> 、不需要在代码中填写appkey,具体操作如下



```dart
//app->build.gradle
dependencies {
implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"
implementation 'com.huawei.hms:push:5.1.1.301'
implementation 'cn.jiguang.sdk.plugin:huawei:3.9.0'
compile 'com.tencent.mm.opensdk:wechat-sdk-android-without-mta:+'
compile 'cn.jiguang.sdk.plugin:xiaomi:3.9.0'//版本号和对应的JPush版本号相同
compile 'cn.jiguang.sdk.plugin:oppo:3.9.0'
compile 'cn.jiguang.sdk.plugin:vivo:3.9.0'
compile 'cn.jiguang.sdk.plugin:meizu:3.9.0'
}
apply plugin: 'com.huawei.agconnect' //此处用以调用agconnect动态状态管理器
```

> 



```dart
//android->build.gradle
buildscript {
ext.kotlin_version = '1.4.10'//'1.3.50'
repositories {
      google()
      jcenter()
    maven {url 'http://developer.huawei.com/repo/'}
}

dependencies {
    classpath 'com.android.tools.build:gradle'
    classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    classpath 'com.android.tools.build:gradle:3.3.2'
    classpath 'com.huawei.agconnect:agcp:1.2.1.301'
    
}
}

allprojects {
repositories {
      google()
      jcenter()
    maven {url 'http://developer.huawei.com/repo/'}
}
}
```

> 



```go
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"////添加此处代码
package="xxxxxx">
<application
    tools:replace="android:label" ////添加此处代码
    android:usesCleartextTraffic="true"
    ......
```

> ### 万事都有意外状况，如果你的项目中有集成环信通讯，仔细的你会发现推送不好用了，调试时会发现获取不到Devicetoken，不要慌，这是因为环信对iOS原生代理重写了导致Devicetoken获取被环信拦截了，解决办法就是，先注册环信登录，就好了，原理就是先让环信去获取Devicetoken😁目前作者也没什么更好的办法，有更的解决方式欢迎留言，谢谢点赞支持！！！！



